syntax = "proto3";

import "proto/db/proto_option.proto";
import "proto/common/base/tip.proto";
import "proto/common/base/user_accounts.proto";

option go_package = "login/proto/login;login";
package loginpb;

message LoginSessionInfo {
  string account = 1;
  uint64 role_id = 2;
  uint64 session_id = 3;
  uint64 gate_id = 4;
  string device_id = 5;
  int64 login_time = 6;
  string fsm = 7;
}

message AccountSimplePlayerWrapper
{
  AccountSimplePlayer player = 1;
}

message LoginRequest
{
  string account = 1;
  string password = 2;
}

message LoginResponse
{
  TipInfoMessage error_message = 1;
  repeated AccountSimplePlayerWrapper players = 2;
}

message TestResponse
{
  TipInfoMessage error_message = 1;
  repeated AccountSimplePlayerWrapper players = 2;
  repeated string teststring = 3;
  repeated int32 testint = 4;
}

message CreatePlayerRequest
{
}

message CreatePlayerResponse
{
  TipInfoMessage error_message = 1;
  repeated AccountSimplePlayerWrapper players = 2;
}

message EnterGameRequest
{
  uint64 player_id  = 1;

  // 新增：客户端生成的幂等 request id（客户端重试同一次业务请求时必须复用）
  string request_id = 2;
}

message EnterGameResponse
{
  TipInfoMessage error_message = 1;
  uint64 player_id  = 2;
}

message LeaveGameRequest
{
}

message LoginNodeDisconnectRequest
{
  uint64 session_id = 1;
}

message LoginEmptyResponse
{
}

service ClientPlayerLogin  {
  option (OptionIsClientProtocolService) = true;

  rpc Login (LoginRequest) returns (LoginResponse);
  rpc CreatePlayer (CreatePlayerRequest) returns (CreatePlayerResponse);
  rpc EnterGame (EnterGameRequest) returns (EnterGameResponse);
  rpc LeaveGame (LeaveGameRequest) returns (LoginEmptyResponse);
  rpc Disconnect (LoginNodeDisconnectRequest) returns (LoginEmptyResponse);
}
